\chapter{Epidemiologia matematica e reti}
Introduciamo in questo capitolo il modello compartimentale di Kermack-McKendrick~\cite{kermack} e ne analizziamo le propriet\`a principali. Ci focalizzeremo in particolare sui suoi aspetti costitutivi, le propriet\`a analitiche e l'applicazione ad un primo caso realistico.
\section{Il modello SIR}{\label{modellosir}}
Il modello SIR \`e un modello compartimentale: la popolazione  viene suddivisa in tre classi: \begin{itemize}
	\item $S$: i \textit{suscettibili}  ovvero individui che possono contrarre la malattia;
	\item $I$: gli \textit{infetti} ovvero coloro che sono ammalati;
	\item $R$: i \textit{rimossi} ovvero  quelli tolti dalle classi precedenti perch\`e completamente guariti (dunque immuni).
	\end{itemize}
	Tale modello si basa su alcune assunzioni.
	\begin{itemize}
		\item[A1] Il numero della popolazione \`e costante nel tempo e verr\`a indicato con $N$, ovvero non si considerano nuove nascite o morti. Inoltre stiamo assumendo che $N$ sia sufficientemente grande da poter considerare la variazione in ogni classe continua e non discreta.
\item[A2] Esiste un fattore di contatto  $\beta$. Tale rapporto indica il valor medio di contatti per infettivo per unit\`a di tempo.
		\item[A3] Gli infetti lasciano la classe al tasso $\alpha$ per unit\`a di tempo e vanno nella classe $R$, un individuo che entra nella classe $R$ non uscir\`a da tale classe.
	\end{itemize}
Da queste considerazioni segue che 
\begin{equation}
\label{SIR}
\begin{aligned}
  S'&=-\beta S I,\\
  I'&= \beta S I -\alpha I,\\
  R'&=\alpha I.
\end{aligned}
\end{equation}
Poich\`e abbiamo assunto che $N=S+I+R$ sia costante, il sistema precedente risulta equivalente a 
\begin{equation}
\label{SI}
\begin{aligned}
  S'&=-\beta S I,\\
  I'&= \beta S I -\alpha I.
\end{aligned}
\end{equation}\\ 
Studiamo cosa succede se introduciamo un piccolo numero di infetti in una popolazione di suscettibili, ovvero consideriamo il sistema~\eqref{SI} con le condizioni iniziali
\begin{equation*}
\begin{aligned}
  I(0)&=I_0>0 ,\, I_0 \ll N \text{ e } \\
  S(0)&=S_0= N-I_0.
\end{aligned}
\end{equation*}
Da~\eqref{SI} osserviamo che $S'<0$ per ogni tempo $t$,  mentre $I'>0$ se~e~solo~se~$\frac{\beta S }{\alpha}~>~1 $.\\
Definiamo  
$$ \ro  = \frac{\beta S_0 }{\alpha}$$ 
il \textit{ numero  di riproduttivit\`a di base}. Esso  rappresenta il numero di individui infettati all'interno di una popolazione di suscettibili.\\
Tale valore ci permette di descrivere la fase iniziale dell'epidemia:
\begin{itemize}
	\item se $\ro<1$ allora l'epidemia si estingue infatti sotto queste condizioni $I'(t)<0$ per ogni tempo $t$,
	\item se $\ro>1$ allora $I$ inizialmente aumenta e dunque l'epidemia ha inizio.
\end{itemize}
Studiamo ora  gli equilibri del sistema autonomo di equazioni differenziali~\eqref{SI}.\\
Sommando le due equazioni  che definiscono tale  sistema otteniamo 
\begin{equation}
	\label{(S+I)'}(S+I)' = -\alpha I.
\end{equation}
Ora $S+I$ \`e una funzione non negativa, decrescente dunque ammette un limite.\\
Poich\`e la derivata di una funzione decrescente e limitata deve tendere a $0$ si ha $$I(t)\to 0.$$
Da queste due osservazioni si ha $$S(t) \to S_\infty. $$ 
Integrando  da $0$ a $+\infty$ in~\eqref{(S+I)'} otteniamo 
$$ \alpha \int_0^{+\infty} I(t) \di t = -\int_0^{+\infty} \tonde{ S(t) + I(t)}' = N -S_\infty.$$ 
In~\eqref{SI}, dividendo per $S$ e integrando da $0$ a $T$ otteniamo 
\begin{equation}\label{rel_finale} \log \frac{S_0}{S_\infty} = \beta \int_0^{+\infty} I(t) \di t =  \frac{\beta}{\alpha} \tonde{ N - S_\infty }= \ro \tonde{ 1 - \frac{S_\infty}{N}}.
\end{equation}
L'equazione~\eqref{rel_finale} prende il nome di \textit{relazione di dimensione finale} infatti fornisce una relazione tra il numero $\ro$ e la dimensione dell'epidemia,  ovvero il numero di membri che sono stati infetti nel corso dell'epidemia: $ N-S_\infty$.
\begin{oss}
Poich\`e il lato destro della~\eqref{rel_finale} \`e finito lo \`e anche il lato sinistro:  $S_\infty >0$ ovvero finita l'epidemia esisteranno ancora degli individui suscettibili.	
\end{oss}

\begin{prop}
La relazione finale~\eqref{rel_finale}  ha un'unica soluzione.
\proof 
Sia 
$$ g(x) =\log \frac{S_0}{x} -\ro \tonde{ 1 -\frac{x}{N}}, $$
ora 
$$\lim_{x\to 0^+} g(x)>0 \text{  e }  g(N) =\log\frac{S_0}{N} < 0, $$ 
mentre
$$g'(x)=-\frac{1}{x} + \frac{\ro}{N} < 0\quad \ses x < \frac{N}{\ro}. $$
\begin{itemize}
	\item Se $\ro\leq 1 $,   allora $N < \frac{N}{\ro}$ dunque $g$ decresce da un valore positivo in $0^+$  fino ad un valore negativo in $N$.\\
	In questo caso  $g(x)$ ammette un'unico zero   $S_\infty$ con $S_\infty< N $.
	\item Se $\ro >1$, allora $g(x)$ \`e monotona decrescente da un valore positivo in $0^+$ fino al minimo in $\frac{N}{\ro}$.\\
Ora
$$ g\tonde{ \frac{S_0}{\ro}} =\log \ro - \ro +\frac{S_0}{N}\leq \log \ro \leq  \ro + 1 <0,$$
dove la penultima disuguaglianza deriva da $\log x < x - 1$ se $x>0$.\\
Dunque $g(x)$ ha un unico zero in $S_\infty$ con $S_\infty< \frac{N}{\ro}$.
\end{itemize}
\endproof	
\end{prop}

\vspace{0.5 cm}

Possiamo inoltre  ora a descrivere le orbite delle soluzioni nel piano $(S,I)$ con
$$ \log \frac{S_0}{S(t)} =\beta \int_0^{+\infty } I(t) \di t = \frac{\beta}{\alpha} \tonde{ N- S(t) - I(t)}
$$
ottenuta dividendo per $S$ l'equazione~\eqref{SI} e integrando tra $0$ a $t$. 

\newpage

In generale, per poter studiare ed applicare il modello occorre inoltre stimare i parametri.\\ Il fattore $\beta$ \`e di difficile stima: dipende dalla malattia in esame e,  in particolar modo, da fattori sociali e comportamentali.\\
I valori di $S_0$ e $S_\infty$ possono essere ricavati tramite test sierologici (misurazione della risposta immunitaria tramite analisi del sangue): da questi valori usando la~\eqref{rel_finale} possiamo stimare $\ro$.\\
Questa stima tuttavia \`e a posteriori, cio\`e pu\`o essere ricavata solamente dopo che l'epidemia ha fatto il suo corso.\\ \\
Un altro modo per stimare $\beta$ pu\`o essere ricavato dalla seguente approssimazione
$$ I' = \tonde{ \beta N -\alpha } I,$$ 
da cui si ottiene che il numero degli infetti cresce esponenzialmente con un tasso di crescita 
$$ r =\beta N - \alpha = \alpha \tonde{ \ro -1},$$
ricavabile dall'incidenza della malattia  all'inizio dell'epidemia.\\Otteniamo cos\`i 
$$ \beta = \frac{r + \alpha } {N}.$$
Oltre ai parametri $\alpha,\beta$ due misure fondamentali nello studio dell'epidemia sono l'incidenza e la prevalenza di cui usiamo la definizione data dal comitato di esperti dell'OMS~\cite{world1959expert}.\\ \\ 
La \textit{prevalenza} indica il numero di individui malati in una determinata popolazione, senza nessuna distinzione tra nuovi e vecchi casi.La prevalenza può essere registrata in un determinato momento (prevalenza puntuale) o durante un determinato periodo di tempo (periodo di prevalenza). La ``prevalenza puntiforme"  è solitamente espressa come una frazione, il denominatore \`e il numero della popolazione.\\ \\
L'\textit{incidenza} \`e il numeri di  individui che si ammalano durante un dato periodo in una specifica popolazione. L'incidenza \`e solitamente espressa come frazione, il denomitare \`e il numero medio di persone nella popolazione.
\newpage

\begin{oss}[Immunizzazione]
Se un gruppo di infetti viene introdotto in una popolazione,  \`e possibile ridurre l'impatto dell'epidemia diminuedo $\ro$.\\
Una strategia pu\`o essere tramite l'immunizzazione, il cui scopo \`e quello di trasferire membri della popolazione della classe $S$ a quella $R$, cos\`i facendo viene ridotto il numero $S_0$ e dunque anche $\ro$.\\
Supponiamo che una frazione $p$ della popolazione sia  immunizzata: il numeri dei suscettibili passa da $S_0$ a $S_0(1-p)$.\\
Se inizialmente il numero di riproduzione di base era $\ro = \frac{\beta N}{\alpha}$, nella nuova situazione diventa $\ro''=\frac{\beta N(1-p)}{\alpha}$  da cui si ha che  
$$\frac{\beta N(1-p)}{\alpha}< 1\quad \ses \quad p> 1-\frac{\alpha}{\beta N} = 1 -\frac{1}{\ro}.
$$
\end{oss}
\newpage
\subsection{Un esempio}
Vediamo ora un esempio di applicazione di questo modello.\\
Analizziamo i dati della peste bubonica del $1665-66$ nel villaggio di Eyam in Inghilterra~\cite{raggett1982stochastic}. \\
I membri del villaggio hanno annotato giorno per giorno il numero di decessi. Per appianare alcune significative variazioni giornaliera nel tasso di mortalit\`a,  Raggett~\cite{raggett1982stochastic} ha raccolto  i dati con una cadenza di $15 \frac{1}{2}$ giorni a partire dal $18$ Giugno del $1666$ (Tabella~\ref{table::1}).
\begin{table}[!ht]
\centering
\caption{Popolazione di deceduti e rimossi.}
\label{table::1}
\begin{tabular}{l | c | c }

Periodo (1666) & Deceduti & Rimossi (alla fine del periodo) \\
\hline

19 Giugno-3/4 Luglio & 11.5 & 11.5\\
4/5 Luglio-19 Luglio & 26.5 & 38\\ 
20 Luglio-3/4 Agosto & 40.5 & 78.5\\
4/5 Agosto-19 Agosto & 41.5 & 120\\
20 Agosto-3/4 Settembre & 25 & 145\\
4/5 Settembre-19 Settembre & 11 & 156\\
20 Settembre-4/5 Ottobre & 11.5 & 167.5\\
5/6 Ottobre-20 Ottobre & 10.5 & 178\\

\end{tabular}

\end{table}

Prendendo come periodo medio di infezione  $11$ giorni, possiamo stimare il numero degli infetti. Alla fine di ogni intervallo di tempo il numero di infetti \`e dato analizzando il diario dei decessi degli $11$ giorni successivi.\\
Sfruttando la relazione 
$$ N = S(t) + I(t) + R(t),$$ 
otteniamo la Tabella~\ref{table::2}.
\begin{table}[!ht]
\centering
\caption{Numero di suscettibili ed infetti. Dati reali.}

 $S(0) = 254$ $I(0) = 7$ e $N = 261$ 	\\
\label{table::2}
\begin{tabular}{l|c|c}

Data (1666) & S & I\\
\cline{1-3}
3/4 Luglio  & 235& 14.5\\
19 Luglio  & 201 & 22\\
3/4 Agosto  & 153.5& 29\\
19  Agosto  & 121& 20\\
3/4 Settembre  & 108&  8\\
19 Settembre  & 97& 8\\
4/5 Ottobre  & Sconosciuti& Sconosciuti\\
20 Ottobre  & 83& 0\\
 
\end{tabular}
\end{table}

Ora sfruttando ~\eqref{rel_finale} otteniamo $\frac{\alpha}{\beta} \simeq 159$.
\newpage

Simulando il modello~\eqref{SI} con condizioni iniziali $S(0) = 254$ e  $I(0)=7$,   utilizzando come parametri $\alpha =2.73 $ e $\beta  = 0.0178 $ troviamo i risultati in Tabella~\ref{table::3} e i grafici di $S,I$ e $R$ come funzioni del tempo (Figura~
\ref{fig::sirsemplice}(a)).\\  \\
La Figura~\ref{fig::sirsemplice}(b) mostra i punti reali insieme al ritratto di fase per il modello~\eqref{SI}: notiamo che i  dati effettivi sono notevolmente vicini alle previsioni ottenute. \begin{table}[ht]
\centering
\caption{Numero di suscettibili ed infetti. Dati sperimentali.}
$S(0) = 254$ $I(0) = 7$ e $N = 261$ \\
\label{table::3}
\begin{tabular}{l|c|c}

Data (1666) & S & I\\
\cline{1-3}
3/4 Luglio  & 230& 15\\
19 Luglio  & 190 & 26\\
3/4 Agosto  & 147& 30\\
19  Agosto  & 115& 24\\
3/4 Settembre  & 96&  15\\
19 Settembre  & 86& 9\\
4/5 Ottobre  & 81& 4\\
20 Ottobre  & 78& 2\\
 
\end{tabular}
\end{table}

\begin{figure}[ht]
\centering
\subfloat[][]{\input{Figure/SIR_Grafico}}
\subfloat[][]{\input{Figure/SI}}
\caption[Analisi dei dati della peste di Eyam]{Popolazione delle singole classi  in funzioni del tempo (a) e orbite nel piano $(S,I)$ (b).  Per ottenere i grafici abbiamo risolto  numericamente, usando MATLAB,  il problema di Cauchy~\eqref{SI} con  condizioni iniziali $S(0)=254, ~I(0)~=~7$.  Per quanto riguarda i parametri, abbiamo considerato    $\alpha=2.73$  e $\beta= 0.0178$.}
\label{fig::sirsemplice}
\end{figure}


%%% Local Variables:
%%% mode: latex
%%% TeX-master: "main"
%%% End:

