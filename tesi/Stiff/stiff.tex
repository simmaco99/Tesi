\documentclass[11pt]{article}
\input{Preambolo.tex}
\begin{document}
Consideriamo il sistema 
\begin{equation}
\begin{cases}
y'= F(y)\\
y(0 )=y_0 
\end{cases}	
\end{equation}
Sia $J$ la matrice Jacobiana di $F$ definiamo l'\textit{indice di stiff} del sistema come il rapporto 
$$ \frac{\lambda_{\max}}{\lambda_{\min}}$$ 
ovvero il rapporto tra l'autovalore di modulo massimo e quello di modulo minimo.\\
Diremo che un sistema \`e stiff se l'indice \`e un numero molto maggiore di $1$.\\ \\
Andiamo a studiare come i parametri ($\tau$,$\gamma$ e la dimensione del network) influiscono sul fatto che il modello chiuso alle coppie sia pi\`u o meno stiff. Per fare questo abbiamo calcolato l'indice di stiff per alcune matrici di Erdos-Renyi vedi Figura~\ref{Erdos}.\\
Per tali matrici inoltre abbiamo osservato anche come aumentasse il numero di intervalli temporali usando le funzione di MATLAB ode45 e ode 15s. Come si evince dai grafici~\ref{Erdos_Lenght} la funzione ode15s richiede sempre un numero minore di intervalli temporale. Possiamo dunque conclduere che il modello in esame risulta stiff.\\ \\
Andiamo ora a indagare sul tempo di calcolo, in particolare abbiamo confrontato ode15s (a cui abbiamo passato anche il Jacobiano) con ode45 ottenendo che in tutti i casi la funzione ode45 impiega meno tempo~\ref{Erdos_tempo}.\\ \\ 
In~\ref{stiff_soluzione} si osserva come varia l'indice di stiff lungo le soluzioni del sistema di ode.

\begin{figure}[h]
\centering
\subfloat[][$N=10$]
{\resizebox{0.45\textwidth}{!}{\input{G10}}}
 \hfill 
\subfloat[][$N=20$]
{\resizebox{0.45\textwidth}{!}{ \input{G20}}}  \\
\subfloat[][$N=30$]
{\resizebox{0.45\textwidth}{!}{\input{G30}}}
 \hfill 
\subfloat[][$N=40$]
{\resizebox{0.45\textwidth}{!}{ \input{G40}}}  \\
\subfloat[][$N=50$]
{\resizebox{0.45\textwidth}{!}{\input{G50}}}
 \hfill 
\subfloat[][$N=60$]
{\resizebox{0.45\textwidth}{!}{ \input{G60}}} 

\caption{Nei grafici viene rappresentato come varia l'indice di stiff (nelle condizioni iniziali)  facendo variare $\tau$ per alcuni valori di $\gamma$ fissati.\\
Per realizzare questi grafici abbiamo utilizzato grafi di Erdos-Renyi con probabilit\`a $0.5$ e dimensione $N$ }
\label{Erdos}
\end{figure}

\begin{figure}[h]
\centering
\subfloat[][$N=10$]
{\resizebox{0.45\textwidth}{!}{\input{G10_Lenght}}}
 \hfill 
\subfloat[][$N=20$]
{\resizebox{0.45\textwidth}{!}{ \input{G20_Lenght}}}  \\
\subfloat[][$N=30$]
{\resizebox{0.45\textwidth}{!}{\input{G30_Lenght}}}
 \hfill 
\subfloat[][$N=40$]
{\resizebox{0.45\textwidth}{!}{ \input{G40_Lenght}}}  \\
\subfloat[][$N=50$]
{\resizebox{0.45\textwidth}{!}{\input{G50_Lenght}}}
 \hfill 
\subfloat[][$N=60$]
{\resizebox{0.45\textwidth}{!}{ \input{G60_Lenght}}} 
\caption{Nei grafici viene rappresentato come varia la differenza tra gli intervalli temporali calcolati da ode45 e ode15s facendo variare $\tau$ per alcuni valori di $\gamma$ fissati.\\
Per realizzare questi grafici abbiamo utilizzato grafi di Erdos-Renyi con probabilit\`a $0.5$  e dimensione $N$}
\label{Erdos_Lenght}

\end{figure}
\begin{figure}
	\centering
 \input{15svs45}
 \caption{Nei grafici vengono  rappresentati i tempi (in scala logaritmica) necessari per la risoluzione del sistema di ode  utilizzando le funzioni ode45 e ode15s.  Per ottenere dei risultati attendibili,  abbiamo ripetuto la misura del tempo $100$ volte.  I parametri utilizzati sono $\tau =0.3$ e $\gamma =0.1$}
 \label{Erdos_tempo}
\end{figure}

\begin{figure}
\centering
\input{stiff_soluzioni}
\caption{Nei grafici vengono  rappresentato l'indice di stiff (in scala logaritmica) in funzione del tempo  per la risoluzione del sistema di ode.I parametri utilizzati sono $\tau =0.3$ e $\gamma =0.1$}
 \label{stiff_soluzione}
\end{figure}
\end{document}
